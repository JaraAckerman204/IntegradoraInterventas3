<ion-header>
  <ion-toolbar class="main-toolbar">

    <!-- Contenedor principal -->
    <div class="toolbar-content">

      <!-- IZQUIERDA: solo logo -->
      <div class="left-section">
        <ion-img class="imglogo" src="../../assets/img/logo.png" alt="Logo Interventas" routerLink="/home"></ion-img>
      </div>

      <!-- CENTRO: secciones (solo desktop) -->
      <div class="center-section">
        <ion-button fill="clear" class="navboton" routerLink="/home" [class.active-link]="isHomeActive()">INICIO</ion-button>
        <ion-button fill="clear" class="navboton" (click)="toggleDropdown('nosotros', $event)" [class.active-link]="isNosotrosActive()">NOSOTROS</ion-button>
        <ion-button fill="clear" class="navboton" (click)="toggleDropdown('productos', $event)" [class.active-link]="isProductosActive()">PRODUCTOS</ion-button>
        <ion-button fill="clear" class="navboton" routerLink="/sucursales" [class.active-link]="isSucursalesActive()">SUCURSALES</ion-button>
      </div>

      <!-- DERECHA: ícono de perfil + menú móvil -->
      <div class="right-section">
        <!-- Botón de perfil -->
        <ion-button fill="clear" (click)="toggleProfileMenu()" class="profile-menu-btn">
          <ion-icon [icon]="personCircleOutline" class="profile-icon"></ion-icon>
        </ion-button>

        <!-- Botón hamburguesa (solo móvil) -->
        <ion-buttons slot="end" class="menu-toggle">
          <ion-button (click)="toggleMenu()">
            <ion-icon [icon]="menuOutline" class="menu-icon"></ion-icon>
          </ion-button>
        </ion-buttons>
      </div>

    </div> <!-- /.toolbar-content -->

  </ion-toolbar>

  <!-- ========================================== -->
  <!-- DROPDOWN NOSOTROS (DESKTOP) -->
  <!-- ========================================== -->
  <div class="dropdown-menu desktop-dropdown" 
       *ngIf="showNosotrosDropdown" 
       [style.top]="dropdownPosition['top']"
       [style.left]="dropdownPosition['left']">
    <ion-button fill="clear" class="dropdown-item" routerLink="/nosotros/contacto" (click)="closeMenu()">CONTACTO</ion-button>
    <ion-button fill="clear" class="dropdown-item" routerLink="/nosotros/informacion" (click)="closeMenu()">INFORMACIÓN</ion-button>
    <div class="bicolor-bar"></div>
  </div>

  <!-- ========================================== -->
  <!-- DROPDOWN PRODUCTOS (DESKTOP) -->
  <!-- ========================================== -->
  <div class="dropdown-menu desktop-dropdown" 
       *ngIf="showProductosDropdown" 
       [style.top]="dropdownPosition['top']"
       [style.left]="dropdownPosition['left']">
    <ion-button fill="clear" class="dropdown-item" routerLink="/productos/todos" (click)="closeMenu()">TODOS</ion-button>
    <ion-button fill="clear" class="dropdown-item" routerLink="/productos/desechables" (click)="closeMenu()">DESECHABLES</ion-button>
    <ion-button fill="clear" class="dropdown-item" routerLink="/productos/biodegradables" (click)="closeMenu()">BIODEGRADABLES</ion-button>
    <ion-button fill="clear" class="dropdown-item" routerLink="/productos/bolsas" (click)="closeMenu()">BOLSAS</ion-button>
    <ion-button fill="clear" class="dropdown-item" routerLink="/productos/cocina-reposteria" (click)="closeMenu()">COCINA Y REPOSTERÍA</ion-button>
    <ion-button fill="clear" class="dropdown-item" routerLink="/productos/alimentos" (click)="closeMenu()">ALIMENTOS</ion-button>
    <ion-button fill="clear" class="dropdown-item" routerLink="/productos/higienicos-servilletas" (click)="closeMenu()">HIGIÉNICOS Y SERVILLETAS</ion-button>
    <div class="bicolor-bar"></div>
  </div>

  <!-- ========================================== -->
  <!-- MENÚ DE PERFIL -->
  <!-- ========================================== -->
  <div class="profile-menu" *ngIf="showProfileMenu">
    <!-- Auth info -->
    <div class="profile-menu-content">
      <ng-container *ngIf="user; else profileNotLogged">
        <div class="user-info-header">
          <ion-icon [icon]="personCircleOutline" class="user-avatar"></ion-icon>
          <div class="user-details">
            <p class="greeting">Bienvenido</p>
            <p class="user-email">{{ user.email }}</p>
          </div>
        </div>
        <ion-button expand="block" color="danger" (click)="logout()" class="logout-btn">
          <ion-icon [icon]="logOutOutline" slot="start"></ion-icon>
          Cerrar sesión
        </ion-button>
      </ng-container>

      <ng-template #profileNotLogged>
        <div class="not-logged-header">
          <ion-icon [icon]="personCircleOutline" class="guest-avatar"></ion-icon>
          <p class="guest-text">Inicia sesión para acceder a tu cuenta</p>
        </div>
        <ion-button expand="block" class="btn-login-gradient" routerLink="/login" (click)="closeProfileMenu()">
          <ion-icon [icon]="logInOutline" slot="start"></ion-icon>
          Iniciar sesión
        </ion-button>
      </ng-template>
    </div>
  </div>

  <!-- ========================================== -->
  <!-- MENÚ MÓVIL DE NAVEGACIÓN -->
  <!-- ========================================== -->
  <div class="mobile-menu" *ngIf="showMobileMenu">
    <ion-button fill="clear" class="mobile-item" routerLink="/home" [class.active-link]="isHomeActive()" (click)="closeMenu()">INICIO</ion-button>
    
    <!-- NOSOTROS con submenu -->
    <ion-button fill="clear" class="mobile-item" (click)="toggleDropdown('nosotros', $event)" [class.active-link]="isNosotrosActive()">
      NOSOTROS
    </ion-button>
    
    <!-- Dropdown NOSOTROS dentro del menú móvil -->
    <div class="dropdown-menu" *ngIf="showNosotrosDropdown && showMobileMenu">
      <ion-button fill="clear" class="dropdown-item" routerLink="/nosotros/contacto" (click)="closeMenu()">CONTACTO</ion-button>
      <ion-button fill="clear" class="dropdown-item" routerLink="/nosotros/informacion" (click)="closeMenu()">INFORMACIÓN</ion-button>
    </div>

    <!-- PRODUCTOS con submenu -->
    <ion-button fill="clear" class="mobile-item" (click)="toggleDropdown('productos', $event)" [class.active-link]="isProductosActive()">
      PRODUCTOS
    </ion-button>
    
    <!-- Dropdown PRODUCTOS dentro del menú móvil -->
    <div class="dropdown-menu" *ngIf="showProductosDropdown && showMobileMenu">
      <ion-button fill="clear" class="dropdown-item" routerLink="/productos/todos" (click)="closeMenu()">TODOS</ion-button>
      <ion-button fill="clear" class="dropdown-item" routerLink="/productos/desechables" (click)="closeMenu()">DESECHABLES</ion-button>
      <ion-button fill="clear" class="dropdown-item" routerLink="/productos/biodegradables" (click)="closeMenu()">BIODEGRADABLES</ion-button>
      <ion-button fill="clear" class="dropdown-item" routerLink="/productos/bolsas" (click)="closeMenu()">BOLSAS</ion-button>
      <ion-button fill="clear" class="dropdown-item" routerLink="/productos/cocina-reposteria" (click)="closeMenu()">COCINA Y REPOSTERÍA</ion-button>
      <ion-button fill="clear" class="dropdown-item" routerLink="/productos/alimentos" (click)="closeMenu()">ALIMENTOS</ion-button>
      <ion-button fill="clear" class="dropdown-item" routerLink="/productos/higienicos-servilletas" (click)="closeMenu()">HIGIÉNICOS Y SERVILLETAS</ion-button>
    </div>

    <ion-button fill="clear" class="mobile-item" routerLink="/sucursales" [class.active-link]="isSucursalesActive()" (click)="closeMenu()">SUCURSALES</ion-button>
  </div>

  <!-- Barra de color inferior -->
  <div class="bicolor-bar"></div>

</ion-header>